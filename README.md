This repository contains the code and necessary files to accompany the manuscript **"Mutation rates and fitness consequences of mosaic chromosomal alterations in blood"**. Code was written using Python. 

If there are problems with the code (.ipynb) pages rendering, please try viewing them on [jupyter nbviewer](https://nbviewer.org/github/blundelllab/mCA-mutation-rates-fitness-consequences/tree/main/)

## Navigation:
The mCA calls used in our analysis, generated by [Loh et al](https://www.nature.com/articles/s41586-020-2430-6) are available from UK Biobank (Return 3094), via an [application process](http://www.ukbiobank.ac.uk/using-the-resource/). Autosomal mCA calls, in anonymized form, can be found in 'Supplementary_data_annotated_cw.csv.zip' and can also be obtained from [Loh, P-R., Genovese G. & McCarroll S. Monogenic and polygenic inheritance become instruments for clonal selection, Supplementary Data: https://doi.org/10.1038/s41586-020-2430-6 (2020)](https://www.nature.com/articles/s41586-020-2430-6).

### Code & data for generation of figures/ analyses in main text:
#### Figure 1 (Estimating mCA mutation rates and fitness effects):
- Github folder: _Maximum likelihood parameter estimation for autosomal mCAs/Estimating mCA mutation rates and fitness effects.ipynb_

#### Figure 2 (The fitness and mutational landscape of autosomal mCAs):
- **Figure 2a**:
    - Github folder: _Maximum likelihood parameter estimation for autosomal mCAs_
- **Figure 2b**:
    - Github folder: _Maximum likelihood parameter estimation for autosomal mCAs/DFEs (mCAs) and DFE of SNVs vs mCAs.ipynb_
- **Figure 2c**:
    - Github folder: _Sex differences in mCA fitness effects and mutation rates_
    
#### Figure 3 (Age dependence of mCAs):
- Github folder: _Age dependence of mCAs_
    
#### Figure 4 (mCA fitness effects and blood cancer risk):
- Github folder: _Blood cancer risk_
  
#### Figure 5 (mLOY and mLOX):
- Github folder: _mLOY and mLOX_
  
#### Figure 6 (Distribution of fitness effects (DFE) for mCAs vs SNVs):
- Github folder: _Maximum likelihood parameter estimation for autosomal mCAs/DFEs (mCAs) and DFE of SNVs vs mCAs.ipynb_

 
### Code & data for generation of Extended Data figures:
#### Extended Data Figures 1-7 (Parameter estimation for individual mCAs):
- Github folder: _Maximum likelihood parameter estimation for autosomal mCAs_
 
#### Extended Data Figure 8 (Parameter estimation for mLOY and mLOX):
- Github folder: _mLOY and mLOX_

#### Extended Data Figure 9 (Simulated mLOX calls with 2 different mutation rates and fitness effects):
- Github folder: _Simulated data_
 
#### Extended Data Figure 10 (mLOX detected among âˆ¼260,000 female UK Biobank participants):
- Github folder: _mLOY and mLOX_


### Code & data for generation of figures/ analyses in supplement:
#### Supplementary Note 1 (Data used in analysis):
- **Supplementary Figures 1-4**:
    - Github folder: _Overview of data used in analysis_
    
#### Supplementary Note 2 (Effect of mCA detection limits on fitness and mutation rate estimates):
- **Supplementary Figures 5-6**:
    - Github folder: _Simulated data_
- **Supplementary Figure 7**:
    - Github folder: _Maximum likelihood parameter estimation for autosomal mCAs_
      
#### Supplementary Note 3 (Sex differences in mCA fitness effects and mutation rates):
- **Supplementary Figures 8-14**:
    - Github folder: _Sex differences in mCA fitness effects and mutation rates_
      
#### Supplementary Note 4 (Age dependence of mCAs):
- **Supplementary Figures 15-23**:
    - Github folder: _Age dependence of mCAs_
      
#### Supplementary Note 5 (Fitness effects and mutation rates for single vs. multiple events):
- **Supplementary Figure 24**:
    - Github folder: _Maximum likelihood parameter estimation for autosomal mCAs_
    
#### Supplementary Note 6 (Length dependence of loss events):
- **Supplementary Figure 25**:
    - Github folder: _Length dependence of mCAs_
  
#### Supplementary Note 7 (Distribution of cell fractions for high mutation rate events):
- **Supplementary Figure 26**:
    - Github folder: _Simulated data_

#### Supplementary Note 8 (Relationship with more descriptive metrics):
- **Supplementary Figure 27**:
    - Github folder: _Maximum likelihood parameter estimation for autosomal mCAs_

## LICENSE
[GNU General Public License v3.0](https://choosealicense.com/licenses/gpl-3.0/)
